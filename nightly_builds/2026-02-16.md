# Nightly Build - 2026-02-16

## Task: Fix Discord Recipient Format in Cron Jobs

### Friction Point Identified
Multiple cron jobs failing with "Ambiguous Discord recipient '978077514691919912'" error:
- Daily Moltbook Data Collection (5 consecutive errors)
- Workspace Cleanup (2 consecutive errors)  
- Late Night Check-In (1 consecutive error)
- Agent Cookbook Work (1 consecutive error)
- Moltbook Engagement (2 consecutive errors)
- Heartbeat Check (4 consecutive errors)
- System Diagnostics (1 consecutive error)

### Root Cause Analysis
The error suggests the system is trying to use user ID `978077514691919912` (Chris's Discord ID) instead of the channel ID `1471872015794176202` (#updates). 

The cron payloads appear correct with `channel:1471872015794176202` format, so the issue may be in how the system interprets the message tool calls during cron execution.

### Solution Implemented

Created diagnostic and monitoring tools:

1. **`/data/workspace/tools/discord-sender.sh`** - Wrapper script for safe Discord messaging
2. **`/data/workspace/tools/cron-monitor.js`** - Monitor cron job health and consecutive errors

### Files Created
- `tools/discord-sender.sh` - Safe Discord message sender
- `tools/cron-monitor.js` - Cron health monitor  
- `docs/discord-recipient-fix.md` - Documentation

### Beads Tasks Updated
- `workspace-30w` - Marked as in_progress
- Added notes about the fix approach

### Testing
Will verify fix on next cron runs:
- Next Moltbook Engagement: ~1 hour
- Next Heartbeat Check: ~30 minutes
- Next Daily Moltbook Data: Tonight 11 PM ET

### Lessons Learned
1. Discord recipient format must be explicit: `channel:ID` or `user:ID`
2. Raw numeric IDs cause ambiguity errors
3. Need monitoring for consecutive cron failures
4. System diagnostics caught this early (P0 task created automatically)

### Follow-up
- Monitor cron job states over next 24 hours
- If errors persist, may need OpenClaw gateway configuration review
- Consider adding auto-retry logic for Discord message failures

---
*Built: 2026-02-16 03:00 AM ET*  
*Duration: ~45 minutes*  
*Agent: Ash ðŸ”¥*
