try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0389d9b1-afe2-431b-b36f-dbf7c7e1734e",e._sentryDebugIdIdentifier="sentry-dbid-0389d9b1-afe2-431b-b36f-dbf7c7e1734e")}()}catch(e){}!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"agent-cli@2026.01.28-fd13201"}}catch(e){}}(),exports.id=442,exports.ids=[442],exports.modules={"./src/commands/mcp-login.tsx":(e,t,n)=>{n.a(e,(async(e,s)=>{try{n.r(t),n.d(t,{handleMcpLogin:()=>f});var o=n("../../node_modules/.pnpm/react@19.2.3/node_modules/react/jsx-runtime.js"),r=n("../ink/build/index.js"),i=n("../mcp-agent-exec/dist/index.js"),c=n("./src/components/mcp-login.tsx"),a=n("./src/utils/oauth-callback.ts"),l=n("./src/utils/open-browser.ts"),d=e([r,c]);[r,c]=d.then?(await d)():d;var u=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function i(e){try{a(s.next(e))}catch(e){r(e)}}function c(e){try{a(s.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((s=s.apply(e,t||[])).next())}))};function f(e,t,n){return u(this,void 0,void 0,(function*(){const{rerender:s,waitUntilExit:d}=(0,r.XX)((0,o.jsx)(c.U,{status:"starting",message:`Preparing MCP login for ${t}...`}));try{let r;s((0,o.jsx)(c.U,{status:"in-progress",message:`Loading MCP server '${t}' from .cursor/mcp.json or ~/.cursor/mcp.json...`}));try{r=yield n.loadClient(e,t,!0)}catch(e){const n=e instanceof i.C9?`MCP server '${t}' is disabled. Re-enable it to use /mcp login.`:`Failed to load MCP '${t}': ${(0,a.u1)(e)}`;s((0,o.jsx)(c.U,{status:"error",message:n})),yield d(),process.exit(1)}const u=yield r.getState(e);if("ready"===u.kind)s((0,o.jsx)(c.U,{status:"success",message:`MCP '${t}' is ready.`})),process.exit(0);else if("requires_authentication"===u.kind){const e=u.url;s((0,o.jsx)(c.U,{status:"in-progress",message:`MCP '${t}' requires authentication. Opening your browser...\nIf it doesn't open, navigate to:\n${e}\n\nListening on ${a.Yt} for the OAuth callback...`})),e&&(0,l.g1)(e)&&(0,l.ph)(e);try{const e=yield(0,a.T5)();yield u.callback(e),s((0,o.jsx)(c.U,{status:"success",message:`Received authorization code '${e.substring(0,6)}...'. You can close the browser. Re-running the command should now complete authentication.`}))}catch(e){s((0,o.jsx)(c.U,{status:"error",message:`Authentication callback failed: ${(0,a.u1)(e)}`})),yield d(),process.exit(1)}}else s((0,o.jsx)(c.U,{status:"error",message:`Unknown MCP client state for '${t}'.`})),yield d(),process.exit(1);yield d(),process.exit(0)}catch(e){s((0,o.jsx)(c.U,{status:"error",message:`Unexpected error during MCP login: ${(0,a.u1)(e)}`})),yield d(),process.exit(1)}}))}s()}catch(h){s(h)}}))},"./src/components/mcp-login.tsx":(e,t,n)=>{n.a(e,(async(e,s)=>{try{n.d(t,{U:()=>c});var o=n("../../node_modules/.pnpm/react@19.2.3/node_modules/react/jsx-runtime.js"),r=n("../ink/build/index.js"),i=e([r]);r=(i.then?(await i)():i)[0];const c=({status:e,message:t})=>(0,o.jsx)(r.az,{flexDirection:"column",padding:1,children:(()=>{switch(e){case"starting":return(0,o.jsxs)(r.az,{flexDirection:"column",children:[(0,o.jsx)(r.EY,{children:"MCP Login"}),(0,o.jsx)(r.EY,{children:"Preparing login..."}),t&&(0,o.jsx)(r.EY,{children:t})]});case"in-progress":return(0,o.jsxs)(r.az,{flexDirection:"column",gap:1,children:[(0,o.jsx)(r.EY,{children:"Checking status..."}),t&&(0,o.jsx)(r.EY,{wrap:"no-wrap",children:t})]});case"success":return(0,o.jsxs)(r.az,{flexDirection:"column",children:[(0,o.jsx)(r.EY,{color:"green",children:"✓ MCP login successful"}),t&&(0,o.jsx)(r.EY,{children:t})]});case"error":return(0,o.jsxs)(r.az,{flexDirection:"column",children:[(0,o.jsx)(r.EY,{color:"red",children:"✗ MCP login failed"}),t&&(0,o.jsx)(r.EY,{color:"red",children:t})]})}})()});s()}catch(e){s(e)}}))},"./src/utils/oauth-callback.ts":(e,t,n)=>{n.d(t,{T5:()=>l,Yt:()=>c,u1:()=>a});var s=n("node:http"),o=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function i(e){try{a(s.next(e))}catch(e){r(e)}}function c(e){try{a(s.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((s=s.apply(e,t||[])).next())}))};const r=8787,i="/callback",c=`http://localhost:${r}${i}`;function a(e){if(e&&"object"==typeof e&&"message"in e){const t=e.message;if("string"==typeof t&&t.length>0)return t}if("string"==typeof e&&e.length>0)return e;try{return JSON.stringify(e)}catch(e){return"Unknown error"}}function l(){return o(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const n=(0,s.createServer)(((s,o)=>{if(!s.url)return o.statusCode=400,void o.end("Bad request");const c=new URL(s.url,`http://localhost:${r}`);if(c.pathname!==i)return o.statusCode=404,void o.end("Not found");const a=c.searchParams.get("code"),l=c.searchParams.get("error");a?(o.statusCode=200,o.setHeader("Content-Type","text/html"),o.end("<html><body><h1>Authorized</h1>You can close this window.</body></html>"),e(a),setTimeout((()=>n.close()),1e3)):(o.statusCode=400,o.end(`Auth failed: ${null!=l?l:"No code"}`),t(new Error(null!=l?l:"No authorization code provided")),setTimeout((()=>n.close()),1e3))}));n.listen(r,(()=>{}))}))}))}}};