try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8448067a-75c2-45fd-a41c-d5009f790b69",e._sentryDebugIdIdentifier="sentry-dbid-8448067a-75c2-45fd-a41c-d5009f790b69")}()}catch(e){}!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"agent-cli@2026.01.28-fd13201"}}catch(e){}}(),exports.id=567,exports.ids=[567],exports.modules={"./src/commands/create-chat.ts":(e,t,i)=>{i.r(t),i.d(t,{handleCreateChat:()=>h});var s=i("node:crypto"),n=i.n(s),o=i("node:path"),r=i("../agent-kv/dist/index.js"),d=i("./src/console-io.ts"),a=i("./src/state/index.ts"),l=i("./src/state/sqlite-blob-store.ts"),u=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{a(s.next(e))}catch(e){o(e)}}function d(e){try{a(s.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}a((s=s.apply(e,t||[])).next())}))};function h(){return u(this,void 0,void 0,(function*(){try{const e=n().randomUUID(),t=(0,a.r)(),i=(0,o.join)(t,e),s=(0,o.join)(i,"store.db"),u=new l.M(s),h=new r.pH(u,u);u.set("agentId",e);const c=h.getId();(0,d.OT)(c),yield h.dispose()}catch(e){(0,d.p2)(`Failed to create chat: ${e instanceof Error?e.message:String(e)}`),process.exit(1)}}))}},"./src/state/index.ts":(e,t,i)=>{i.d(t,{r:()=>r});var s=i("node:crypto"),n=i("node:path"),o=i("../cursor-config/dist/index.js");function r(){const e=(0,s.createHash)("md5").update(process.cwd()).digest("hex");return(0,n.join)((0,o.WI)(),"chats",e)}},"./src/state/sqlite-blob-store.ts":(e,t,i)=>{i.d(t,{M:()=>c});var s=i("node:fs"),n=i("node:path"),o=i("../agent-kv/dist/index.js"),r=i("../utils/dist/index.js"),d=i("../../node_modules/.pnpm/sqlite3@5.1.7_patch_hash=aee4b045019cd42c3fc35610736c4496fa74db4d4a28d55c814724e29047da6a/node_modules/sqlite3/lib/sqlite3.js"),a=i.n(d),l=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{a(s.next(e))}catch(e){o(e)}}function d(e){try{a(s.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}a((s=s.apply(e,t||[])).next())}))};const u=new o.aY;class h extends a().Database{}class c extends r.jG{static initAndLoad(e){return l(this,void 0,void 0,(function*(){const t=new c(e);return yield t.getDb(),t}))}constructor(e){super(),this.dbPath=e,this.listeners={agentId:new Set,latestRootBlobId:new Set,name:new Set,createdAt:new Set,mode:new Set,lastUsedModel:new Set},this.isPersisting=!1,this.persistQueued=!1,this.isDisposing=!1,this.inFlightOps=0;const t=(0,n.basename)((0,n.dirname)(this.dbPath));this.metadata=(0,o.sh)(t)}getDb(){return l(this,void 0,void 0,(function*(){return this.dbPromise||(this.dbPromise=new Promise(((e,t)=>{const i=(0,n.dirname)(this.dbPath);(0,s.existsSync)(i)||(0,s.mkdirSync)(i,{recursive:!0});const r=new h(this.dbPath,(i=>{i?t(i):r.serialize((()=>{r.run("PRAGMA journal_mode = WAL"),r.run("PRAGMA synchronous = NORMAL"),r.run("PRAGMA user_version = 1"),r.run("CREATE TABLE IF NOT EXISTS blobs (id TEXT PRIMARY KEY, data BLOB)"),r.run("CREATE TABLE IF NOT EXISTS meta (key TEXT PRIMARY KEY, value TEXT)",(i=>{i?t(i):r.get("SELECT value FROM meta WHERE key = ?","0",((i,s)=>{if(i)t(i);else{if(null==s?void 0:s.value){const e=(0,o.aD)(s.value);this.metadata=u.deserialize(e)}else{const e=u.serialize(this.metadata),t=(0,o.nj)(e);r.run("INSERT OR REPLACE INTO meta (key, value) VALUES (?, ?)","0",t)}e(r)}}))}))}))}))}))),this.dbPromise}))}getBlob(e,t){return l(this,void 0,void 0,(function*(){if(!this.isDisposing){this.inFlightOps++;try{const e=yield this.getDb(),i=(0,o.nj)(t);return yield new Promise(((t,s)=>{e.get("SELECT data FROM blobs WHERE id = ?",i,((e,i)=>{e?s(e):i&&null!=i.data?t(new Uint8Array(i.data)):t(void 0)}))}))}finally{this.inFlightOps--}}}))}setBlob(e,t,i){return l(this,void 0,void 0,(function*(){if(!this.isDisposing){this.inFlightOps++;try{const e=yield this.getDb(),s=(0,o.nj)(t);return yield new Promise(((t,n)=>{e.run("INSERT OR REPLACE INTO blobs (id, data) VALUES (?, ?)",s,Buffer.from(i),(e=>{e?n(e):t()}))}))}finally{this.inFlightOps--}}}))}setBlobLocallyOnly(e,t,i){return l(this,void 0,void 0,(function*(){return Promise.resolve()}))}flush(e){return l(this,void 0,void 0,(function*(){return Promise.resolve()}))}get(e){return this.metadata[e]}valuesEqual(e,t,i){if("latestRootBlobId"===e){const e=t,s=i;if(e===s)return!0;if(!e||!s)return!1;if(e.length!==s.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==s[t])return!1;return!0}return t===i}schedulePersist(){this.dbPromise&&(this.isDisposing||(this.isPersisting?this.persistQueued=!0:(this.isPersisting=!0,this.persistMetadata().finally((()=>{this.isPersisting=!1,this.persistQueued&&(this.persistQueued=!1,this.schedulePersist())})))))}set(e,t){const i=this.metadata[e];if(this.valuesEqual(e,i,t))return;this.metadata=Object.assign(Object.assign({},this.metadata),{[e]:t}),this.dbPromise&&this.schedulePersist();const s=this.listeners[e];s&&s.size>0&&queueMicrotask((()=>{s.forEach((e=>{e()}))}))}persistMetadata(){return l(this,void 0,void 0,(function*(){if(!this.isDisposing){this.inFlightOps++;try{const e=yield this.getDb(),t=u.serialize(this.metadata),i=(0,o.nj)(t);return yield new Promise(((t,s)=>{e.run("INSERT OR REPLACE INTO meta (key, value) VALUES (?, ?)","0",i,(e=>{e?s(e):t()}))}))}finally{this.inFlightOps--}}}))}subscribe(e,t){const i=this.listeners[e];return i?(i.add(t),()=>i.delete(t)):()=>{}}dispose(){return l(this,void 0,void 0,(function*(){return this.disposePromise?this.disposePromise:this.dbPromise?(this.disposePromise=this.cleanup().then((()=>{this.dbPromise=void 0})),this.disposePromise):void 0}))}cleanup(){return l(this,void 0,void 0,(function*(){if(!this.dbPromise)return;for(this.isDisposing=!0,this.persistQueued=!1;this.isPersisting||this.inFlightOps>0;)yield new Promise((e=>setTimeout(e,10)));const e=yield this.dbPromise,t=yield new Promise(((t,i)=>{e.get("SELECT value FROM meta WHERE key = ?","0",((e,s)=>{e?i(e):t(s)}))}));let i=0;if(null==t?void 0:t.value){const e=(0,o.aD)(t.value);i=u.deserialize(e).latestRootBlobId.length}if(yield new Promise((t=>{e.close((()=>t()))})),0!==i);else{this.dbPromise=void 0;const e=(0,n.dirname)(this.dbPath);try{(0,s.rmSync)(e,{recursive:!0,force:!0})}catch(e){}}}))}}}};